{% extends 'base.html.twig' %}

{% block title %}Mon panier - GreenGoodies{% endblock %}

{% block stylesheets %}
  <style>
    .btn-custom {
      background-color: #565656;
      border-radius: 0;
      color: #fff;
      transition: background-color .2s ease;
      padding: 1.1rem 1rem;
    }
    .btn-custom:hover { background-color: #040404; color: #fff; }

    .cart-wrap { max-width: 620px; }

    .link-muted {
      color: #6c757d;
      text-decoration: none;
      font-size: .9rem;
    }
    .link-muted:hover { text-decoration: underline; }

    .cart-card { background: #fff; }
    .cart-sep { border-top: 10px solid rgb(247, 241, 237); }

    .product-img {
      width: 110px;
      height: 110px;
      object-fit: cover;
      border-radius: 0;
      background: #f3f3f3;
    }
  </style>
{% endblock %}

{% block body %}
<section class="cart py-5" style="background-color: rgb(247, 241, 237); min-height: 100vh;">
  <div class="container">
    <div class="mx-auto cart-wrap">

      <h3 class="text-center mb-2">Mon panier</h3>

      {% if items is empty %}
        <p class="text-center text-muted mb-0">Votre panier est vide.</p>
      {% else %}

        <div class="d-flex justify-content-start mb-3">
          <form method="post" action="{{ path('app_cart_clear') }}">
            <button type="submit" class="btn btn-link p-0 link-muted">× Vider le panier</button>
          </form>
        </div>

        {# Carte panier (produit + récap) #}
        <div class="cart-card p-0">
          {# Partie produit #}
          <div class="p-5">
            {% for item in items %}
              <div class="d-flex align-items-start gap-4 mb-4">
                <img
                  src="{{ item.product.imagePath }}"
                  alt="{{ item.product.name }}"
                  class="product-img"
                >

                <div class="flex-grow-1">
                  <div class="fw-semibold mb-1">{{ item.product.name }}</div>
                  <div class="text-muted" style="font-size:.95rem;">Quantité : {{ item.quantity }}</div>

                  <div class="mt-3 fs-5">
                    {{ (item.quantity * item.product.price)|number_format(2, '.', ' ') }}€
                  </div>
                </div>
              </div>

              {# séparateur si plusieurs items #}

            {% endfor %}
          </div>

          <div class="cart-sep"></div>
          <div class="p-4 px-5">
            <div class="d-flex justify-content-end align-items-baseline gap-2 pe-2">
              <div class="text-muted" style="font-size:.95rem;">Total panier :</div>
              <div class="fs-5">{{ total|number_format(2, '.', ' ') }}€</div>
            </div>
            <div class="d-flex justify-content-end">
              <div class="text-muted" style="font-size:.85rem;">  Frais de livraison : Offert</div>
            </div>
          </div>
        </div>

        <div class="mt-4">
          <form method="post" action="{{ path('app_cart_validate') }}">
            <button type="submit" class="btn btn-custom w-100">
              Valider la commande
            </button>
          </form>
        </div>

      {% endif %}
    </div>
  </div>
</section>
{% endblock %}
